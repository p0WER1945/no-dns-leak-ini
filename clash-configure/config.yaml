# =========================
# æœºåœºè®¢é˜…é…ç½®
# =========================
proxy-providers:
  sub0:
    url: "è®¢é˜…åœ°å€, ä¿ç•™å¼•å·"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
    proxy: ç›´è¿

  # sub1:
  #   url: "è®¢é˜…åœ°å€, ä¿ç•™å¼•å·"
  #   type: http
  #   interval: 86400
  #   health-check:
  #     enable: true
  #     url: http://www.gstatic.com/generate_204
  #     interval: 300
  #   proxy: ç›´è¿

# =========================
# åŸºç¡€é…ç½®
# =========================
port: 7890
socks-port: 7891
mixed-port: 7893
allow-lan: true
bind-address: "*"
mode: rule
log-level: info
ipv6: false

# ã€ä¼˜åŒ–ã€‘å¼€å¯ TCP å¹¶å‘ï¼Œæ˜¾è‘—é™ä½æ¡æ‰‹å»¶è¿Ÿ
tcp-concurrent: true

# ã€ä¼˜åŒ–ã€‘æ¨¡æ‹Ÿ TLS æŒ‡çº¹ï¼Œé˜²æ­¢è¢«æŸäº›æœåŠ¡ç«¯è¯†åˆ«ä¸ºä»£ç†å·¥å…·
global-client-fingerprint: chrome

# =========================
# DNS é…ç½® (é˜²æ³„éœ²æ ¸å¿ƒ)
# =========================
dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  
  # ã€ä¼˜åŒ–ã€‘é˜²æ­¢ç³»ç»Ÿè¿æ¥æ£€æµ‹è¯¯æŠ¥ï¼Œå¯¼è‡´æ— æ³•è”ç½‘
  fake-ip-filter:
    - "*.lan"
    - "*.localdomain"
    - "*.localhost"
    - "*.local"
    - "msftconnecttest.com"
    - "msftncsi.com"
    - "succ.html"
    - "time.*.com"
    - "time.*.gov"
    - "time.*.edu.cn"
    - "time.*.apple.com"
  
  # é»˜è®¤ DNS (ç”¨äºè§£æ DoH åŸŸåçš„ IP)
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  # å›½å†…åŸŸå DNS (å»ºè®®ä½¿ç”¨é˜¿é‡Œå’Œè…¾è®¯çš„ DoHï¼Œé˜²æ­¢ 53 ç«¯å£åŠ«æŒ)
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

  # å›½å¤–åŸŸå fallback (å½“å›½å†… DNS è§£æç»“æœæ˜¯æ±¡æŸ“ IP æ—¶å›é€€åˆ°è¿™é‡Œ)
  fallback:
    - https://dns.google/dns-query
    - https://1.1.1.1/dns-query
    - tls://8.8.4.4:853

  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32

# =========================
# ä»£ç†èŠ‚ç‚¹ (æ­¤å¤„éœ€è¦ä¿ç•™ä½ è®¢é˜…ä¸­çš„èŠ‚ç‚¹)
# =========================
proxies:
  # âš ï¸ è¯·ç¡®ä¿è¿™é‡Œæœ‰ä½ çš„æœºåœºèŠ‚ç‚¹ï¼Œæˆ–è€…ç”±å¤–éƒ¨è®¢é˜…ç®¡ç†
  - name: "ç›´è¿"
    type: direct

# =========================
# ä»£ç†ç»„é…ç½®
# =========================
proxy-groups:
  # ä¸»è¦èŠ‚ç‚¹é€‰æ‹©ç»„
  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡-è‡ªåŠ¨
      - ğŸ‡­ğŸ‡° é¦™æ¸¯-è‡ªåŠ¨
      - ğŸ‡¨ğŸ‡³ å°æ¹¾-è‡ªåŠ¨
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬-è‡ªåŠ¨
      - ğŸ‡ºğŸ‡¸ ç¾å›½-è‡ªåŠ¨
      - ç›´è¿
    include-all: true
  
  # è‡ªåŠ¨é€‰æ‹©ç»„ï¼šä¼˜åŒ–äº† toleranceï¼Œé¿å…é¢‘ç¹è·³åŠ¨
  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡-è‡ªåŠ¨
    type: url-test
    include-all: true
    filter: "(?i)(å¹¿æ–°|æ–°åŠ å¡|SG|å¡|ç‹®åŸ|ğŸ‡¸ğŸ‡¬|Singapore)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    timeout: 50
  
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯-è‡ªåŠ¨
    type: url-test
    include-all: true
    filter: "(?i)(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°|HongKong)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    timeout: 50
  
  - name: ğŸ‡¨ğŸ‡³ å°æ¹¾-è‡ªåŠ¨
    type: url-test
    include-all: true
    filter: "(?i)(å¹¿å°|å°æ¹¾|å°ç£|TW|Tai Wan|ğŸ‡¹ğŸ‡¼|ğŸ‡¨ğŸ‡³|TaiWan|Taiwan)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    timeout: 50
  
  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬-è‡ªåŠ¨
    type: url-test
    include-all: true
    filter: "(?i)(å¹¿æ—¥|æ—¥æœ¬|JP|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|ğŸ‡¯ğŸ‡µ|Japan)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    timeout: 50
  
  - name: ğŸ‡ºğŸ‡¸ ç¾å›½-è‡ªåŠ¨
    type: url-test
    include-all: true
    filter: "(?i)(å¹¿ç¾|ç¾|US|çº½çº¦|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯|æ´›æ‰|åœ£ä½•å¡|åœ£å…‹æ‹‰|è¥¿é›…|èŠåŠ |ğŸ‡ºğŸ‡¸|United States)"
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    timeout: 50

# =========================
# è§„åˆ™éƒ¨åˆ† (ä»ä¸Šåˆ°ä¸‹åŒ¹é…)
# =========================
rules:
  # 1. é˜»æ–­ QUIC/HTTP3 (é˜²æ­¢ Google ç»•è¿‡ä»£ç†) - å¿…é¡»æ”¾åœ¨æœ€å‰é¢
  - AND,((NETWORK,UDP),(DST-PORT,443)),REJECT
  
  # 2. é˜»æ–­ WebRTC (é˜²æ­¢æµè§ˆå™¨æ³„éœ²)
  - DOMAIN-SUFFIX,stun.l.google.com,REJECT
  
  # ============================================
  # ã€æ–°å¢ã€‘å¼ºåˆ¶ Google åŸŸåèµ°ä»£ç† (åŒé‡ä¿é™©)
  # æ”¾åœ¨è§„åˆ™é›†ä¹‹å‰ï¼Œé˜²æ­¢è§„åˆ™é›†æ¼æ‰
  # ============================================
  - DOMAIN-SUFFIX,google.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,google.co.jp,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-KEYWORD,google,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-KEYWORD,gmail,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-KEYWORD,youtube,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # ç›´æ¥åŸŸåè§„åˆ™
  - DOMAIN-SUFFIX,xn--ngstr-lra8j.com,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - DOMAIN-SUFFIX,services.googleapis.cn,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # å¤–éƒ¨è§„åˆ™é›†
  - RULE-SET,google_cn_proxy,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  
  # æœ¬åœ°ç½‘ç»œå’Œè§£å°è§„åˆ™
  - RULE-SET,local_area_network,ç›´è¿
  - RULE-SET,unban,ç›´è¿
  
  # ä¸­å›½åŸŸåå’Œåª’ä½“
  - RULE-SET,china_domain,ç›´è¿
  - RULE-SET,china_media,ç›´è¿
  
  # å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,ban_ad,REJECT
  - RULE-SET,ban_program_ad,REJECT
  
  # ä¸­å›½ IP ç›¸å…³
  - RULE-SET,china_company_ip,ç›´è¿,no-resolve
  - RULE-SET,china_ip,ç›´è¿,no-resolve
  
  # GeoIP å…œåº• (é˜²æ­¢è§„åˆ™é›†æ¼ç½‘)
  - GEOIP,CN,ç›´è¿,no-resolve
  
  # æœ€ç»ˆå…œåº•
  - MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©

# =========================
# è§„åˆ™é›†é…ç½® (ä¼˜åŒ–ä¸º CDN åŠ é€Ÿåœ°å€)
# =========================
rule-providers:
  # ã€ä¼˜åŒ–ã€‘æ‰€æœ‰ URL å·²æ›¿æ¢ä¸º jsdelivr CDNï¼Œè§£å†³ GitHub è®¿é—®æ…¢/å¤±è´¥å¯¼è‡´æ— æ³•å¯åŠ¨çš„é—®é¢˜
  google_cn_proxy:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/GoogleCNProxyIP.list"
    path: ./ruleset/GoogleCNProxyIP.list
    interval: 86400
  
  local_area_network:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/LocalAreaNetwork.list"
    path: ./ruleset/LocalAreaNetwork.list
    interval: 86400
  
  unban:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/UnBan.list"
    path: ./ruleset/UnBan.list
    interval: 86400
  
  china_domain:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaDomain.list"
    path: ./ruleset/ChinaDomain.list
    interval: 86400
  
  china_media:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaMedia.list"
    path: ./ruleset/ChinaMedia.list
    interval: 86400
  
  ban_ad:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanAD.list"
    path: ./ruleset/BanAD.list
    interval: 86400
  
  ban_program_ad:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanProgramAD.list"
    path: ./ruleset/BanProgramAD.list
    interval: 86400
  
  china_company_ip:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaCompanyIp.list"
    path: ./ruleset/ChinaCompanyIp.list
    interval: 86400
  
  china_ip:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaIp.list"
    path: ./ruleset/ChinaIp.list
    interval: 86400